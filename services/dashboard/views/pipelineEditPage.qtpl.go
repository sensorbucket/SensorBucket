// Code generated by qtc from "pipelineEditPage.qtpl". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

// <!--
//     Pipeline model
//     Workers with pagination
//  -->
//

//line services/dashboard/views/pipelineEditPage.qtpl:6
package views

//line services/dashboard/views/pipelineEditPage.qtpl:6
import "sensorbucket.nl/sensorbucket/services/core/processing"

//line services/dashboard/views/pipelineEditPage.qtpl:7
import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

//line services/dashboard/views/pipelineEditPage.qtpl:7
var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

//line services/dashboard/views/pipelineEditPage.qtpl:7
func (p *PipelineEditPage) StreamBody(qw422016 *qt422016.Writer) {
//line services/dashboard/views/pipelineEditPage.qtpl:7
	qw422016.N().S(`
<div class="w-full grid grid-rows-3 grid-cols-5 gap-6">
    <div class="row-span-2 col-span-2 bg-white border rounded-md">
        <header class="border-b py-2 px-4 text-sm text-slate-700">
            Pipeline details
        </header>
        <div class="p-4">
            `)
//line services/dashboard/views/pipelineEditPage.qtpl:14
	StreamPipelineDetailBlock(qw422016, p.Pipeline)
//line services/dashboard/views/pipelineEditPage.qtpl:14
	qw422016.N().S(`
        </div>
    </div>
    <div class="row-span-2 col-span-3 bg-white border rounded-md">
        <div class="row-span-2 col-span-2 bg-white border rounded-md">
            <header class="border-b py-2 px-4 text-sm text-slate-700">
                Pipeline steps
            </header>
            <div class="p-4">
                `)
//line services/dashboard/views/pipelineEditPage.qtpl:23
	StreamRenderPipelineSteps(qw422016, p.Pipeline)
//line services/dashboard/views/pipelineEditPage.qtpl:23
	qw422016.N().S(`
            </div>
        </div>
    </div>
    <div class="row-span-1 col-span-5 bg-white border rounded-md">
        `)
//line services/dashboard/views/pipelineEditPage.qtpl:28
	StreamRenderWorkerTable(qw422016, p.Workers, p.WorkersNextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:28
	qw422016.N().S(`
    </div>
</div>
`)
//line services/dashboard/views/pipelineEditPage.qtpl:31
}

//line services/dashboard/views/pipelineEditPage.qtpl:31
func (p *PipelineEditPage) WriteBody(qq422016 qtio422016.Writer) {
//line services/dashboard/views/pipelineEditPage.qtpl:31
	qw422016 := qt422016.AcquireWriter(qq422016)
//line services/dashboard/views/pipelineEditPage.qtpl:31
	p.StreamBody(qw422016)
//line services/dashboard/views/pipelineEditPage.qtpl:31
	qt422016.ReleaseWriter(qw422016)
//line services/dashboard/views/pipelineEditPage.qtpl:31
}

//line services/dashboard/views/pipelineEditPage.qtpl:31
func (p *PipelineEditPage) Body() string {
//line services/dashboard/views/pipelineEditPage.qtpl:31
	qb422016 := qt422016.AcquireByteBuffer()
//line services/dashboard/views/pipelineEditPage.qtpl:31
	p.WriteBody(qb422016)
//line services/dashboard/views/pipelineEditPage.qtpl:31
	qs422016 := string(qb422016.B)
//line services/dashboard/views/pipelineEditPage.qtpl:31
	qt422016.ReleaseByteBuffer(qb422016)
//line services/dashboard/views/pipelineEditPage.qtpl:31
	return qs422016
//line services/dashboard/views/pipelineEditPage.qtpl:31
}

//line services/dashboard/views/pipelineEditPage.qtpl:33
func StreamRenderWorkerTable(qw422016 *qt422016.Writer, workers []string, nextPage string) {
//line services/dashboard/views/pipelineEditPage.qtpl:33
	qw422016.N().S(`
    <table class="w-full text-sm border-separate border-spacing-0" id="worker-table">
        <thead class="text-left text-slate-500 sticky top-0 bg-white">
            <tr class="h-10">
                <th class="font-normal border-b align-middle px-4">
                    Worker ID
                </th>
                <th class="font-normal border-b align-middle px-4">
                    Worker Name
                </th>
            </tr>
        </thead>
        <tbody>
            `)
//line services/dashboard/views/pipelineEditPage.qtpl:46
	StreamRenderWorkerTableRows(qw422016, workers, nextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:46
	qw422016.N().S(`
        </tbody>
    </table>
`)
//line services/dashboard/views/pipelineEditPage.qtpl:49
}

//line services/dashboard/views/pipelineEditPage.qtpl:49
func WriteRenderWorkerTable(qq422016 qtio422016.Writer, workers []string, nextPage string) {
//line services/dashboard/views/pipelineEditPage.qtpl:49
	qw422016 := qt422016.AcquireWriter(qq422016)
//line services/dashboard/views/pipelineEditPage.qtpl:49
	StreamRenderWorkerTable(qw422016, workers, nextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:49
	qt422016.ReleaseWriter(qw422016)
//line services/dashboard/views/pipelineEditPage.qtpl:49
}

//line services/dashboard/views/pipelineEditPage.qtpl:49
func RenderWorkerTable(workers []string, nextPage string) string {
//line services/dashboard/views/pipelineEditPage.qtpl:49
	qb422016 := qt422016.AcquireByteBuffer()
//line services/dashboard/views/pipelineEditPage.qtpl:49
	WriteRenderWorkerTable(qb422016, workers, nextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:49
	qs422016 := string(qb422016.B)
//line services/dashboard/views/pipelineEditPage.qtpl:49
	qt422016.ReleaseByteBuffer(qb422016)
//line services/dashboard/views/pipelineEditPage.qtpl:49
	return qs422016
//line services/dashboard/views/pipelineEditPage.qtpl:49
}

//line services/dashboard/views/pipelineEditPage.qtpl:51
func StreamRenderPipelineSteps(qw422016 *qt422016.Writer, pipeline processing.Pipeline) {
//line services/dashboard/views/pipelineEditPage.qtpl:51
	qw422016.N().S(`
    <script>
        htmx.onLoad(function(content) {
        let sortables = content.querySelectorAll(".sortable");
        const ghostStyles = ['border-dashed', 'border-2', 'border-sky-500', 'bg-white', 'shadow-lg', 'shadow-cyan-500/50'];
        for (var i = 0; i < sortables.length; i++) {
                let sortable = sortables[i];
                let sort = new Sortable(sortable, {
                    animation: 150,

                    // Unfortunately the Sortable JS library does not offer support for multiple classes as the ghost class.
                    // To style it using Tailwind a small hack is required
                    onStart: function(evt) {
                        ghostStyles.forEach((item) => evt.item.classList.add(item));
                    },
                    onEnd: function(evt) {
                        ghostStyles.forEach((item) => evt.item.classList.remove(item));

                        // Update the index for each input item
                        let inputs = sortable.querySelectorAll("input");
                        inputs.forEach((ix, input) => input.value = "stuyffff");
                        for (let i = 0; i < inputs.length; i++) {
                            inputs[i].value = i;
                        }

                        // Now fire the event triggering HTMX to update the pipeline in the backend
                        sortable.dispatchEvent(new Event("steps-updated"));
                    }
                });
            }
        })
    </script>
    <form class="sortable" hx-post="/pipelines/`)
//line services/dashboard/views/pipelineEditPage.qtpl:83
	qw422016.E().S(pipeline.ID)
//line services/dashboard/views/pipelineEditPage.qtpl:83
	qw422016.N().S(`/steps" hx-trigger="steps-updated">
        <div class="htmx-indicator">Updating...</div>
        `)
//line services/dashboard/views/pipelineEditPage.qtpl:85
	StreamRenderPipelineStepsSortable(qw422016, pipeline.Steps)
//line services/dashboard/views/pipelineEditPage.qtpl:85
	qw422016.N().S(`
    </form>
`)
//line services/dashboard/views/pipelineEditPage.qtpl:87
}

//line services/dashboard/views/pipelineEditPage.qtpl:87
func WriteRenderPipelineSteps(qq422016 qtio422016.Writer, pipeline processing.Pipeline) {
//line services/dashboard/views/pipelineEditPage.qtpl:87
	qw422016 := qt422016.AcquireWriter(qq422016)
//line services/dashboard/views/pipelineEditPage.qtpl:87
	StreamRenderPipelineSteps(qw422016, pipeline)
//line services/dashboard/views/pipelineEditPage.qtpl:87
	qt422016.ReleaseWriter(qw422016)
//line services/dashboard/views/pipelineEditPage.qtpl:87
}

//line services/dashboard/views/pipelineEditPage.qtpl:87
func RenderPipelineSteps(pipeline processing.Pipeline) string {
//line services/dashboard/views/pipelineEditPage.qtpl:87
	qb422016 := qt422016.AcquireByteBuffer()
//line services/dashboard/views/pipelineEditPage.qtpl:87
	WriteRenderPipelineSteps(qb422016, pipeline)
//line services/dashboard/views/pipelineEditPage.qtpl:87
	qs422016 := string(qb422016.B)
//line services/dashboard/views/pipelineEditPage.qtpl:87
	qt422016.ReleaseByteBuffer(qb422016)
//line services/dashboard/views/pipelineEditPage.qtpl:87
	return qs422016
//line services/dashboard/views/pipelineEditPage.qtpl:87
}

//line services/dashboard/views/pipelineEditPage.qtpl:89
func StreamRenderPipelineStepsSortable(qw422016 *qt422016.Writer, steps []string) {
//line services/dashboard/views/pipelineEditPage.qtpl:89
	qw422016.N().S(`
    `)
//line services/dashboard/views/pipelineEditPage.qtpl:90
	for ix, step := range steps {
//line services/dashboard/views/pipelineEditPage.qtpl:90
		qw422016.N().S(`
        <div class="p-4 w-2/4 mt-1.5 text-center mx-auto text-white bg-secondary-600 rounded-lg flex justify-start">
            <input type="hidden" name="`)
//line services/dashboard/views/pipelineEditPage.qtpl:92
		qw422016.E().S(step)
//line services/dashboard/views/pipelineEditPage.qtpl:92
		qw422016.N().S(`" value="`)
//line services/dashboard/views/pipelineEditPage.qtpl:92
		qw422016.N().D(ix)
//line services/dashboard/views/pipelineEditPage.qtpl:92
		qw422016.N().S(`" />
            <p>`)
//line services/dashboard/views/pipelineEditPage.qtpl:93
		qw422016.E().S(step)
//line services/dashboard/views/pipelineEditPage.qtpl:93
		qw422016.N().S(`</p>
        </div>
    `)
//line services/dashboard/views/pipelineEditPage.qtpl:95
	}
//line services/dashboard/views/pipelineEditPage.qtpl:95
	qw422016.N().S(`
`)
//line services/dashboard/views/pipelineEditPage.qtpl:96
}

//line services/dashboard/views/pipelineEditPage.qtpl:96
func WriteRenderPipelineStepsSortable(qq422016 qtio422016.Writer, steps []string) {
//line services/dashboard/views/pipelineEditPage.qtpl:96
	qw422016 := qt422016.AcquireWriter(qq422016)
//line services/dashboard/views/pipelineEditPage.qtpl:96
	StreamRenderPipelineStepsSortable(qw422016, steps)
//line services/dashboard/views/pipelineEditPage.qtpl:96
	qt422016.ReleaseWriter(qw422016)
//line services/dashboard/views/pipelineEditPage.qtpl:96
}

//line services/dashboard/views/pipelineEditPage.qtpl:96
func RenderPipelineStepsSortable(steps []string) string {
//line services/dashboard/views/pipelineEditPage.qtpl:96
	qb422016 := qt422016.AcquireByteBuffer()
//line services/dashboard/views/pipelineEditPage.qtpl:96
	WriteRenderPipelineStepsSortable(qb422016, steps)
//line services/dashboard/views/pipelineEditPage.qtpl:96
	qs422016 := string(qb422016.B)
//line services/dashboard/views/pipelineEditPage.qtpl:96
	qt422016.ReleaseByteBuffer(qb422016)
//line services/dashboard/views/pipelineEditPage.qtpl:96
	return qs422016
//line services/dashboard/views/pipelineEditPage.qtpl:96
}

//line services/dashboard/views/pipelineEditPage.qtpl:98
func StreamRenderWorkerTableRows(qw422016 *qt422016.Writer, workers []string, nextPage string) {
//line services/dashboard/views/pipelineEditPage.qtpl:98
	qw422016.N().S(`
    `)
//line services/dashboard/views/pipelineEditPage.qtpl:99
	for ix, worker := range workers {
//line services/dashboard/views/pipelineEditPage.qtpl:99
		qw422016.N().S(`
    <tr
        class="hover:bg-slate-50 group"
        `)
//line services/dashboard/views/pipelineEditPage.qtpl:102
		if nextPage != "" && ix == len(workers)-1 {
//line services/dashboard/views/pipelineEditPage.qtpl:102
			qw422016.N().S(`
        hx-trigger="revealed"
        hx-target="this"
        hx-swap="afterend"
        hx-get="`)
//line services/dashboard/views/pipelineEditPage.qtpl:106
			qw422016.E().S(nextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:106
			qw422016.N().S(`"
        `)
//line services/dashboard/views/pipelineEditPage.qtpl:107
		}
//line services/dashboard/views/pipelineEditPage.qtpl:107
		qw422016.N().S(`
    >
        <td class="px-4 h-10 border-b">`)
//line services/dashboard/views/pipelineEditPage.qtpl:109
		qw422016.E().S(worker)
//line services/dashboard/views/pipelineEditPage.qtpl:109
		qw422016.N().S(`</td>
        <td class="border-b"><a
            class="flex items-center px-4 h-10 text-primary-700 group-hover:underline"
            href="/overview/devices/`)
//line services/dashboard/views/pipelineEditPage.qtpl:112
		qw422016.E().S(worker)
//line services/dashboard/views/pipelineEditPage.qtpl:112
		qw422016.N().S(`"
            hx-target="main"
        >`)
//line services/dashboard/views/pipelineEditPage.qtpl:114
		qw422016.E().S(worker)
//line services/dashboard/views/pipelineEditPage.qtpl:114
		qw422016.N().S(`</a></td>
        <td class="px-4 h-10 border-b">`)
//line services/dashboard/views/pipelineEditPage.qtpl:115
		qw422016.E().S(worker)
//line services/dashboard/views/pipelineEditPage.qtpl:115
		qw422016.N().S(`</td>
        <td class="px-4 h-10 border-b">`)
//line services/dashboard/views/pipelineEditPage.qtpl:116
		qw422016.E().S(worker)
//line services/dashboard/views/pipelineEditPage.qtpl:116
		qw422016.N().S(`</td>
    </tr>
    `)
//line services/dashboard/views/pipelineEditPage.qtpl:118
	}
//line services/dashboard/views/pipelineEditPage.qtpl:118
	qw422016.N().S(`
`)
//line services/dashboard/views/pipelineEditPage.qtpl:119
}

//line services/dashboard/views/pipelineEditPage.qtpl:119
func WriteRenderWorkerTableRows(qq422016 qtio422016.Writer, workers []string, nextPage string) {
//line services/dashboard/views/pipelineEditPage.qtpl:119
	qw422016 := qt422016.AcquireWriter(qq422016)
//line services/dashboard/views/pipelineEditPage.qtpl:119
	StreamRenderWorkerTableRows(qw422016, workers, nextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:119
	qt422016.ReleaseWriter(qw422016)
//line services/dashboard/views/pipelineEditPage.qtpl:119
}

//line services/dashboard/views/pipelineEditPage.qtpl:119
func RenderWorkerTableRows(workers []string, nextPage string) string {
//line services/dashboard/views/pipelineEditPage.qtpl:119
	qb422016 := qt422016.AcquireByteBuffer()
//line services/dashboard/views/pipelineEditPage.qtpl:119
	WriteRenderWorkerTableRows(qb422016, workers, nextPage)
//line services/dashboard/views/pipelineEditPage.qtpl:119
	qs422016 := string(qb422016.B)
//line services/dashboard/views/pipelineEditPage.qtpl:119
	qt422016.ReleaseByteBuffer(qb422016)
//line services/dashboard/views/pipelineEditPage.qtpl:119
	return qs422016
//line services/dashboard/views/pipelineEditPage.qtpl:119
}

//line services/dashboard/views/pipelineEditPage.qtpl:122
type PipelineEditPage struct {
	BasePage
	Pipeline        processing.Pipeline
	Workers         []string
	WorkersNextPage string
}
